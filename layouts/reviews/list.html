{{ define "main" }}
<article class="max-w-full">
    <div class="prose dark:prose-invert max-w-none">
        <h1>{{ .Title }}</h1>
        {{ .Content }}
    </div>

    <div class="my-6">
        <label for="course-type-filter" class="mr-2 font-semibold">筛选课程类型:</label>
        <select id="course-type-filter" class="p-2 border border-neutral-300 dark:border-neutral-600 rounded-lg bg-white dark:bg-neutral-800 focus:ring-2 focus:ring-primary-500">
            <option value="all">显示全部</option>
            <option value="专业课">专业课</option>
            <option value="双学位课">双学位课</option>
            <option value="政治课">政治课</option>
            <option value="通选课">通选课</option>
            <option value="体育课">体育课</option>
        </select>
    </div>

    <div id="course-list" class="space-y-4">
        {{ $pages := where .Site.RegularPages "Section" "reviews" }}
        {{ if eq (len $pages) 0 }}
            <div class="bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-200 p-4" role="alert">
                <p class="font-bold">暂无评测</p>
                <p>这里还没有任何课程评测。快去 `content/reviews` 文件夹下添加第一篇评测吧！</p>
            </div>
        {{ else }}
            {{ range $pages }}
            <div class="course-item bg-neutral-100 dark:bg-neutral-800 p-6 rounded-lg shadow-sm"
                 data-course-type="{{ .Params.course_type | default "" }}">
                <a href="{{ .RelPermalink }}" class="text-2xl font-bold text-primary-500 hover:underline">{{ .Title }}</a>
                <div class="text-sm text-neutral-600 dark:text-neutral-400 mt-2">
                    <span class="inline-block bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 px-2 py-1 rounded-full">
                        {{ .Params.course_type | default "未分类" }}
                    </span>
                </div>
                <p class="mt-4">{{ .Summary }}</p>
                <a href="{{ .RelPermalink }}" class="inline-block mt-4 text-primary-500 font-semibold hover:underline">阅读评测 &rarr;</a>
            </div>
            {{ end }}
        {{ end }}
    </div>
</article>

<style>
    .course-item.hidden {
        display: none;
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const filterSelect = document.getElementById('course-type-filter');
    const courseItems = document.querySelectorAll('.course-item');

    if (!filterSelect) return;

    filterSelect.addEventListener('change', function () {
        const selectedType = this.value;

        courseItems.forEach(item => {
            const itemType = item.dataset.courseType;
            
            if (selectedType === 'all' || itemType === selectedType) {
                item.classList.remove('hidden');
            } else {
                item.classList.add('hidden');
            }
        });
    });
});
</script>
{{ end }}